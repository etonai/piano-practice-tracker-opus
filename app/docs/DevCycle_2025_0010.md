# Development Cycle 2025-0010

**Status:** In Progress  
**Start Date:** 2025-07-30  
**Focus:** Testing Build 1.0.8.25-beta

## Overview

This development cycle focuses on comprehensive testing of build 1.0.8.25-beta, which includes all the bug fixes and feature enhancements implemented in DevCycle 2025-0009. The cycle validates the lifetime activities count fix on piece deletion, piece title text clipping resolution, and the new edit functionality for pieces before proceeding to production release preparation.

## Current Work Items

### Phase 1: Test Build 1.0.8.25-beta
**Status:** üé´ Open  
**Date Added:** 2025-07-30  
**Priority:** Critical  
**Description:** Conduct comprehensive testing of build 1.0.8.25-beta to validate application functionality and ensure readiness for production release. This build includes all Phase 2-4 implementations from DevCycle 2025-0009.
**Build Version:** 1.0.8.25-beta

**Testing Focus Areas:**
- Lifetime activities count accuracy on piece deletion (DevCycle 2025-0009 Phase 2 fix)
- Piece title text display without clipping in detail view (DevCycle 2025-0009 Phase 3 fix)
- Edit functionality for pieces including name and type modification (DevCycle 2025-0009 Phase 4 feature)
- Icon ordering in pieces list: Add Activity ‚Üí Favorite ‚Üí Edit ‚Üí Delete
- All previous functionality from DevCycle 2025-0008 implementations:
  - Yellow star favorites display across all tabs
  - Import/Export Data screen improvements
  - Add Piece screen favorite toggle behavior
  - Suggestions tab activity addition and updates
  - Practice suggestions count limits
  - PlayStreak updates from suggestions tab
  - Dashboard activity listing immediate updates

**Acceptance Criteria:**
- [ ] Complete testing of build 1.0.8.25-beta
- [ ] Verify Phase 2 fix: Lifetime activities count decreases correctly when deleting pieces with activities
- [ ] Verify Phase 3 fix: Piece titles display fully without vertical clipping in detail view
- [ ] Verify Phase 4 feature: Edit functionality works for piece names and types
- [ ] Test edit dialog pre-population with current piece data
- [ ] Validate edit functionality preserves piece statistics and activity associations
- [ ] Confirm icon ordering in pieces list matches specification
- [ ] Verify all DevCycle 2025-0008 fixes continue to work correctly
- [ ] Test application stability and performance with new features
- [ ] Document any issues or bugs discovered during testing
- [ ] Verify application meets quality standards for production release

### Phase 2: Update Target API Level for Google Play Compliance
**Status:** ‚úÖ COMPLETED  
**Date Added:** 2025-07-31  
**Priority:** Critical  
**Description:** Update the app's target API level to meet Google Play requirements before the Aug 31, 2025 deadline. Google has detected that PlayStreak is targeting an old version of Android and requires all apps to meet current target API level requirements for security and user safety.

**Current Status:**
- Target SDK: 36 (successfully updated with UI compatibility fixes)
- Google Play compliance deadline: Aug 31, 2025
- App name referenced in Google notification: PlayStreak
- Google Play Console Issue: https://play.google.com/console/u/0/developers/7182365112407544306/app/4976114423720835461/policy-center/issues/4986177253656722641/details

**Implementation Status:**
- Successfully implemented API 36 compatibility with proper UI handling
- Tab positioning fixed with 24dp margin adjustment
- ActionBar positioning works correctly
- Status bar icon theming properly configured for light/dark modes

**Technical Details:**
- Tab positioning resolved with layout margin adjustments
- Status bar icons properly themed: dark icons in light mode, light icons in dark mode
- App functionality fully compatible with API 36
- No breaking changes introduced by API level update

**Technical Requirements:**
- Verify current targetSdk configuration in app/build.gradle.kts
- Ensure all dependencies are compatible with target API level 36
- Test app functionality on target API level
- Address any deprecated API usage or behavioral changes
- Validate Google Play Console submission requirements

**Acceptance Criteria:**
- [x] Review current targetSdk configuration
- [x] Update targetSdk to API level 36 if not already set
- [x] Update compileSdk to API level 36 if not already set
- [x] Review and update any deprecated API usage
- [x] Implement proper edge-to-edge display handling
- [x] Test app functionality on Android devices running API level 36
- [x] Verify no breaking changes introduced by target API update
- [x] Test app installation and basic functionality
- [x] Prepare for Google Play Console submission
- [x] Document any API migration changes required
- [x] Ensure compliance with Google Play target API requirements

### Phase 3: Fix Missing Performance Suggestions in Suggestions Tab
**Status:** ‚úÖ COMPLETED  
**Date Added:** 2025-07-31  
**Date Completed:** 2025-08-03
**Priority:** High  
**Description:** In the production version of PlayStreak, performance suggestions are not appearing in the Suggestions tab, although they are correctly displayed in the Dashboard. This suggests a data filtering or display logic issue specific to the Suggestions tab implementation.

**Issue Details:**
- Performance suggestions visible in Dashboard ‚úÖ
- Performance suggestions missing from Suggestions tab ‚ùå
- Only affects the production/pro version of the app
- Suggests a conditional logic or data source problem in Suggestions tab

**Investigation Areas:**
- Compare Dashboard vs Suggestions tab data fetching logic
- Check if performance suggestions are being filtered out in Suggestions tab
- Verify database queries and data transformations
- Review any version-specific or premium feature logic
- Test in both debug and release builds to isolate the issue

**Root Cause Analysis:**
After investigating the codebase, the issue has been identified:

**Dashboard Implementation (WORKING CORRECTLY):**
- `DashboardFragment.kt:116-139` observes `viewModel.performanceSuggestions`
- `DashboardViewModel.kt:104-109` calls `suggestionsService.generatePerformanceSuggestions()`
- Performance suggestions are displayed in a separate card (`performanceSuggestionsCard`)

**Suggestions Tab Implementation (BUG IDENTIFIED):**
- `SuggestionsFragment.kt:72-75` **EXPLICITLY HIDES** performance suggestions:
  ```kotlin
  // Hide performance suggestions section completely (no Pro features)
  binding.performanceSuggestionsHeader.visibility = View.GONE
  binding.performanceRecyclerView.visibility = View.GONE
  binding.noPerformanceSuggestionsText.visibility = View.GONE
  ```
- `SuggestionsFragment.kt:58-63` **FILTERS OUT** performance suggestions:
  ```kotlin
  // Only show practice suggestions (no Pro features)
  val practiceSuggestions = suggestions.filter { it.suggestionType == SuggestionType.PRACTICE }
  ```

**Technical Details:**
- `SuggestionsService.generatePerformanceSuggestions()` correctly returns performance suggestions for Pro users
- `ProUserManager.isProUser()` determines Pro status via SharedPreferences
- Dashboard correctly displays performance suggestions for Pro users
- Suggestions tab has hardcoded logic to hide performance suggestions with comment "no Pro features"

**Impact:**
- Pro users see performance suggestions in Dashboard ‚úÖ
- Pro users cannot see performance suggestions in Suggestions tab ‚ùå
- This creates inconsistent user experience between the two screens

**Proposed Solution:**
1. **Remove hardcoded filtering** in `SuggestionsFragment.kt:60` - change from filtering only practice suggestions to showing all suggestions for Pro users
2. **Add Pro user conditional logic** for performance suggestions UI visibility (similar to Dashboard implementation)
3. **Create performance suggestions adapter** and RecyclerView setup for Suggestions tab
4. **Maintain free user experience** - continue hiding performance suggestions for non-Pro users

**Implementation Files to Modify:**
- `SuggestionsFragment.kt` - Remove hardcoded performance suggestions filtering and hiding
- `SuggestionsViewModel.kt` - May need to add separate performance suggestions LiveData
- `fragment_suggestions.xml` - Ensure performance suggestions UI elements exist
- Testing required in both Pro and Free user modes

**Acceptance Criteria:**
- [x] Investigate Suggestions tab data source and filtering logic
- [x] Compare Dashboard performance suggestions implementation  
- [x] Identify root cause of missing performance suggestions
- [ ] Implement fix to display performance suggestions in Suggestions tab
- [ ] Verify performance suggestions appear in both Dashboard and Suggestions tab  
- [ ] Test fix in both debug and production builds
- [ ] Ensure no regression in existing suggestions functionality
- [ ] Document the root cause and solution implemented

### Phase 4: Fix Inconsistent Non-Favorite Practice Suggestion Counts
**Status:** ‚úÖ COMPLETED  
**Date Added:** 2025-07-31  
**Date Completed:** 2025-08-03
**Priority:** High  
**Description:** Pro users see inconsistent counts of non-favorite practice suggestions between Dashboard and Suggestions tab. Dashboard shows 9 non-favorite practice suggestions while Suggestions tab only shows 4, creating an inconsistent user experience.

**Issue Details:**
- Dashboard: Shows 9 non-favorite practice suggestions ‚ùå (incorrectly mixing practice + performance)
- Suggestions tab: Shows only 4 non-favorite practice suggestions ‚úÖ (correct Pro user behavior)
- Dashboard should show only practice suggestions in practice section, not mixed types
- Affects Pro users specifically (Free users have different limits)

**Investigation Areas:**
- Compare practice suggestion limits between Dashboard and Suggestions implementations
- Check if different data sources or filtering logic are being used
- Verify ProUserManager integration in both components
- Review suggestion count limits and how they're applied
- Investigate if SuggestionsService returns different results for different callers

**Root Cause Analysis:**
The discrepancy has been identified through detailed code analysis:

**Dashboard Implementation (INCORRECT - Practice suggestions card shows all suggestion types):**
- `DashboardViewModel.kt:114` calls `suggestionsService.generateAllSuggestions(pieces, activities)` for practice suggestions
- `SuggestionsService.generateAllSuggestions()` returns both practice AND performance suggestions combined
- For Pro users, the combined limit logic at lines 53-55 allows:
  - `finalNonFavoriteLimit = PRO_USER_PRACTICE_NON_FAVORITE_SUGGESTIONS + PRO_USER_PERFORMANCE_SUGGESTIONS`
  - `finalNonFavoriteLimit = 4 + 5 = 9` total non-favorite suggestions (practice + performance combined)
- Dashboard has separate "Practice Suggestions" and "Performance Suggestions" cards
- However, the Practice Suggestions card incorrectly receives ALL suggestion types (practice + performance)
- This results in 9 suggestions (both practice and performance) being displayed in the Practice Suggestions card ‚ùå

**Suggestions Tab Implementation (CORRECT - Shows only practice suggestions):**
- `SuggestionsViewModel.kt:38` calls `suggestionsService.generateAllSuggestions(pieces, activities)` (same as Dashboard)
- However, `SuggestionsFragment.kt:60` **CORRECTLY FILTERS** to practice-only suggestions:
  ```kotlin
  val practiceSuggestions = suggestions.filter { it.suggestionType == SuggestionType.PRACTICE }
  ```
- This filtering correctly separates practice suggestions from performance suggestions
- Shows exactly 4 non-favorite practice suggestions as intended for Pro users ‚úÖ

**Technical Details:**
- `SuggestionsService.generatePracticeSuggestions()` correctly limits non-favorite practice suggestions to exactly 4 for Pro users
- `SuggestionsService.generateAllSuggestions()` returns combined practice + performance suggestions (up to 9 total)
- Dashboard Practice Suggestions card incorrectly displays all suggestion types (9 items: 4 practice + 5 performance)
- Suggestions tab correctly filters and displays only practice suggestions (4 items)

**The Problem:**
The `SuggestionsService.generateAllSuggestions()` algorithm has a bug in its limiting logic. It generates too many practice suggestions (9 instead of 4 for Pro users) due to incorrect limit calculations that combine practice + performance limits. Both Dashboard and Suggestions tab use this flawed algorithm, but Suggestions tab only shows the first 4 results, masking the underlying algorithm bug.

**Impact:**
- Dashboard: Incorrectly shows 9 mixed suggestions as "practice suggestions" ‚ùå
- Suggestions tab: Correctly shows 4 practice suggestions only ‚úÖ  
- This creates user confusion about what constitutes practice vs performance suggestions

**Proposed Solution:**
Fix Dashboard to properly separate practice and performance suggestions like Suggestions tab:

**Required Changes:**
1. **Modify DashboardViewModel.kt** - Change practice suggestions LiveData:
   - Change line 114 from `suggestionsService.generateAllSuggestions()` to `suggestionsService.generatePracticeSuggestions()`
   - Keep existing `generatePerformanceSuggestions()` call for performance suggestions (already correct)
   - This ensures Practice Suggestions card shows only practice suggestions (4 for Pro users)

**Implementation Details:**
- Dashboard has separate cards for Practice and Performance suggestions (already correct UI structure)
- Performance Suggestions card already works correctly (shows 5 performance suggestions for Pro users)
- Only the Practice Suggestions card data source needs to be fixed

**Expected Result:**
- Dashboard practice suggestions: 4 for Pro users (same as Suggestions tab) ‚úÖ
- Dashboard performance suggestions: 5 for Pro users (unchanged) ‚úÖ
- Suggestions tab practice suggestions: 4 for Pro users (already correct) ‚úÖ
- Clear separation between practice and performance suggestion types

**Acceptance Criteria:**
- [x] Investigate why Dashboard shows 9 non-favorite practice suggestions  
- [x] Investigate why Suggestions tab shows only 4 non-favorite practice suggestions
- [x] Identify the source of the count discrepancy between the two screens
- [x] Implement fix to ensure consistent suggestion counts across both screens
- [x] Verify both Dashboard and Suggestions tab show same practice suggestion counts
- [x] Test fix maintains proper Pro vs Free user differentiation
- [x] Ensure no regression in performance suggestion display
- [x] Document the root cause and solution for count consistency

### Phase 5: Fix UI Element Positioning After API 36 Update
**Status:** üîÑ In Progress  
**Date Added:** 2025-08-02  
**Priority:** High  
**Description:** After the API 36 update in Phase 2, various screens are experiencing UI positioning issues where content is being cut off or positioned too close to the top of the screen. The top title bar may be too large, or all screen content needs to be moved down by a few pixels.

**Issue Details:**
- **Select Piece screen:** "Add New" button is either slightly cut off or positioned right at the top edge of the screen
- **Add Activity flow:** When selecting a piece to add as an activity, the piece title is being slightly cut off by the "Select Level" title bar
- **Summary screen:** The "Summary" header is being slightly cut off by the Summary title bar
- **Pattern:** Multiple screens showing content being cut off by their respective title bars

**Root Cause:**
- This issue likely stems from the API 36 update implemented in Phase 2
- The previous fix for tab positioning (24dp margin adjustment) resolved the Dashboard tabs issue
- However, other screens throughout the app were not similarly adjusted for the new API behavior
- Edge-to-edge display changes in API 36 may be affecting content positioning across the app

**Investigation Areas:**
- Review all screens for similar content clipping issues
- Determine if this is a global layout issue requiring system-wide adjustment
- Check if window insets handling needs to be applied consistently across all activities/fragments
- Verify if ActionBar/Toolbar positioning is consistent across different screens

**Proposed Solution Options:**
1. **Global layout adjustment:** Apply consistent top margin/padding across all screens
2. **Per-screen fixes:** Address each affected screen individually with appropriate margins
3. **System-wide insets handling:** Implement proper window insets handling for all activities
4. **ActionBar positioning:** Standardize ActionBar/Toolbar positioning and spacing

**Acceptance Criteria:**
- [ ] Audit all app screens to identify content positioning issues
- [ ] Identify root cause of content being cut off by title bars
- [ ] Implement fix to ensure proper content positioning across all screens
- [ ] Verify "Add New" button on Select Piece screen is properly positioned
- [ ] Verify piece titles are not cut off in Add Activity flow
- [ ] Verify Summary header is not cut off on Summary screen
- [ ] Test fix across different screen sizes and densities
- [ ] Ensure fix doesn't introduce regressions on previously working screens (like Dashboard tabs)
- [ ] Validate consistent UI spacing throughout the app

## Cycle Notes

- This cycle validates build 1.0.8.25-beta which contains all DevCycle 2025-0009 bug fixes and feature enhancements
- Focus on comprehensive testing of new edit functionality and bug fixes
- All testing should be documented with detailed steps and results
- Any issues discovered should be prioritized and tracked for resolution
- Success criteria: build 1.0.8.25-beta passes all testing phases without critical issues

## Previous Cycle Summary

DevCycle 2025-0009 completed the following phases:
1. ‚úÖ Test Build 1.0.8.24-beta (Phase 1)
2. ‚úÖ Fix Lifetime Activities Count Bug on Piece Deletion (Phase 2)
3. ‚úÖ Fix Piece Title Text Clipping in Detail View (Phase 3)
4. ‚úÖ Add Edit Functionality to Pieces Tab (Phase 4)

## Future Cycles

After testing completion, the next cycle will focus on:
- Production release preparation (DevCycle 2025-0011)
- Issue resolution if any critical problems are found
- Post-launch monitoring and iteration planning